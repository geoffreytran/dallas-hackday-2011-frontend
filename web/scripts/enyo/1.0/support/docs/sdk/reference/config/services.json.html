<!DOCTYPE html>
<html>
	<head>
		<title>$if(pagetitle)$$pagetitle$$endif$</title>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<link rel="stylesheet" href="_css/chrome.css" />
		<link rel="stylesheet" href="../_css/chrome.css" />
		<link rel="stylesheet" href="../../_css/chrome.css" />
		<link rel="stylesheet" href="../../../_css/chrome.css" />
		<script src="_js/jquery-1.4.2.min.js" type="text/javascript"></script>
		<script src="../_js/jquery-1.4.2.min.js" type="text/javascript"></script>
		<script src="../../_js/jquery-1.4.2.min.js" type="text/javascript"></script>
		<script src="../../../_js/jquery-1.4.2.min.js" type="text/javascript"></script>
		<script src="_js/doc.js" type="text/javascript"></script>
		<script src="../_js/doc.js" type="text/javascript"></script>
		<script src="../../_js/doc.js" type="text/javascript"></script>
		<script src="../../../_js/doc.js" type="text/javascript"></script>
	</head>
	<body>
		<div id="content">
    
    <h1 id="services.json">
      services.json
    </h1>
    <ul>
      <li>Application properties
      </li>
      <li>Service properties
      </li>
      <li>Command properties
      </li>
      <li>Schemas
      </li>
      <li>Security
      </li>
    </ul>
    <p>
      The <code>services.json</code> file is in the root directory of a Mojo service, and describes how the service is constructed, and how it operates. Generally, only a subset of this <code>services.json</code> file is required to correctly define a service. Here we provide a reference for all properties defined in the file:
    </p>
    <blockquote>
      <pre>
<code>{
  &quot;description&quot;: &lt;optional string&gt;,
  &quot;commandTimeout&quot;, &lt;optional number&gt;,
  &quot;activityTimeout&quot;, &lt;optional number&gt;,
  &quot;services&quot;:
  [
      {
          &quot;name&quot;: &lt;string&gt;,
          &quot;description&quot;: &lt;optional string&gt;,
          &quot;assistant&quot;: &lt;optional string&gt;,
          &quot;commandTimeout&quot;, &lt;optional number&gt;,
          &quot;commands&quot;:
          [
              {
                  &quot;name&quot;: &lt;string&gt;,
                  &quot;description&quot;, &lt;optional string&gt;,
                  &quot;assistant&quot;, &lt;string&gt;,
                  &quot;watch&quot;, &lt;optional boolean&gt;,
                  &quot;subscribe&quot;, &lt;optional boolean&gt;,
                  &quot;schema&quot;, &lt;optional string or object&gt;,
                  &quot;commandTimeout&quot;, &lt;optional number&gt;,
              },
              &lt;...more commands...&gt;
          ]
      },
      &lt;...more services...&gt;
  ],
  &quot;schemas&quot;: &lt;optional object&gt;
  {
      &lt;schema name&gt;: &lt;schema&gt;
  } 
}
</code>
</pre>
    </blockquote>
    <h2 id="application-properties">
      Application properties
    </h2>
    <p>
      The top-level properties are the application properties. These provide configuration for the overall application.
    </p>
    <h3 id="description">
      description
    </h3>
    <p>
      An optional property that should be used to provide an informative aaplication description.
    </p>
    <h3 id="commandtimeout">
      commandTimeout
    </h3>
    <p>
      Defines the number of seconds commands should run before a timeout error is returned to the caller. This can be overridden (see below). If not defined, this defaults to 30 seconds.
    </p>
    <h3 id="activitytimeout">
      activityTimeout
    </h3>
    <p>
      Defines the number of seconds the application continues to run after the completion of the last activity, before it terminates. Services do not run all the time, but launch when needed, and terminate when not in use. Typically, a command is considered to be an activity, so the application will not terminate while a command is being processed. It is also possible to have other non-command activities (e.g., background activities). If not defined, this defaults to 30 seconds.
    </p>
    <h3 id="services">
      services
    </h3>
    <p>
      Defines an array of services being provided by this application. Typically, an application will only provide one service. However, there may be reasons to provide multiple services within the same application (e.g., old API versions). An application must define at least one service (since an application without services probably does not make sense). The properties of a service are defined below.
    </p>
    <p>
      Note: more than one service per application is not currently supported.
    </p>
    <h3 id="schemas">
      schemas
    </h3>
    <p>
      This optional property contains an set of string/schema pairs. See the separate section below on schemas.
    </p>
    <h2 id="service-properties">
      Service properties
    </h2>
    <p>
      Each application defines one or more services.
    </p>
    <h3 id="name">
      name
    </h3>
    <p>
      The name of the service on the Palm Message Bus. All services must define a name. The name must begin with the app name. For example:
    </p>
    <p>
      app name: 'com.palmdts.testacct' service name: 'com.palmdts.testacct.contacts.service'
    </p>
    <h3 id="description-1">
      description
    </h3>
    <p>
      An optional property providing an informative description of this service.
    </p>
    <h3 id="assistant">
      assistant
    </h3>
    <p>
      An optional property defining the name of a class that should be instantiated to manage this service. The service assistant runs only once when the service starts. However, it can be used to store more-persistent state since command assistants are only around when processing a request.
    </p>
    <p>
      For example:
    </p>
    <blockquote>
      <pre>
<code> var assistant = this.controller.service.assistant;
 assistant.saveState(someState);
</code>
</pre>
    </blockquote>
    <h3 id="commandtimeout-1">
      commandTimeout
    </h3>
    <p>
      Defines the number of seconds commands should run before a timeout error is returned to the caller. This overrides any value defined at the application level for this service, but may be overridden in turn by a command (see below). If not defined, this inherits the value defined for the application.
    </p>
    <h3 id="commands">
      commands
    </h3>
    <p>
      Defines an array of commands being provided by this service. A service may provide zero or more commands per service (a service with no commands may simply want to run once when the application is started). The properties of a command are defined below.
    </p>
    <h2 id="command-properties">
      Command properties
    </h2>
    <p>
      Each service defines a number of commands.
    </p>
    <h3 id="name-1">
      name
    </h3>
    <p>
      The name of the command in this service. All commands must define a name.
    </p>
    <h3 id="description-2">
      description
    </h3>
    <p>
      An optional property providing an informative description of this command.
    </p>
    <h3 id="assistant-1">
      assistant
    </h3>
    <p>
      A required property defining the name of a class that should be instantiated to manage this command. The command assistant's run method will ultimately be called to actually execute the command.
    </p>
    <h3 id="watch">
      watch
    </h3>
    <p>
      An optional boolean value, defaulting to false if not present. If defined as true, this command is watchable. A watchable command has two return values to the caller. The first return value is the usual response to the command. The second return value, which is sent sometime later, indicates that the command should be re-executed, because the value it returns may be different from the last time it was called. This mechanism is similar to subscriptions, but is naturally rate-limited by the consumer of the service, resulting in less unnecessary bus traffic and fewer application stampedes when service state changes.
    </p>
    <h3 id="subscribe">
      subscribe
    </h3>
    <p>
      An optional boolean value, defaulting to false if not present. If defined as true, this command supports subscriptions. An application or another service can request a subscription by setting subscribe to true in the request.
    </p>
    <p>
      A subscription is typically used for a command which can take a long time to run, but where incremental progress can be indicated to the caller. The webOS Download Manager is an example of a service that implements subscriptions.
    </p>
    <p>
      Commands which have a subscription active do not time out.
    </p>
    <p>
      For a subscribeable command, the run() function is passed a second parameter, which is a FutureFactory object, which provides Future objects for subsequent responses.
    </p>
    <p>
      Example:
    </p>
    <blockquote>
      <pre>
<code>run: function(future, subscription) {
  var count = 1;
  future.result = { reply: &quot;this is the initial response&quot;};
  this.interval = setInterval(function ping() {
      // subscription.get() returns a future to use for the next response
      var f = subscription.get();
      f.result = { reply: &quot;response #&quot;+count++};
  }, 1000);
},
</code>
</pre>
    </blockquote>
    <p>
      Apps implementing a subscribable ommand should make requests from the application with Mojo.Service.Request, rather than using the Mojo.Controller.SceneController's request() method, since the controller cancels any requests when the scene closes.
    </p>
    <h3 id="schema">
      schema
    </h3>
    <p>
      An optional property defining the JSON schema to use to validate the incoming arguments for the command. The property can either be a JSON schema or a string. If a string is used, this should match a property in the application-level schema object.
    </p>
    <h3 id="commandtimeout-2">
      commandTimeout
    </h3>
    <p>
      Defines the number of seconds this command should run before a timeout error is returned to the caller. This overrides any value defined at the service or application level. If not defined, this inherits the value defined by the service or the application.
    </p>
    <h2 id="schemas-1">
      Schemas
    </h2>
    <p>
      Command arguments may be optionally validated using a JSON Schema. If a schema is used, only commands that pass validation will be executed by the service. Otherwise, schema errors are returned to the caller.
    </p>
    <h3 id="schema-1">
      schema
    </h3>
    <p>
      The schema property at the application level defines a set of string/schema pairs. Each named schema can be referenced by zero or more commands using their schema property. The value of the pair corresponds to a JSON schema, which will be used for command validation.
    </p>
    <h2 id="security">
      Security
    </h2>
    <p>
      The LS2 security role files will be automatically created from <code>services.json</code> at build time. You will be able to override certain default behavior with custom properties in the <code>services.json</code> file. Check back soon for details.
    </p>
		</div>
	</body>
</html>