<!DOCTYPE html>
<html>
	<head>
		<title>$if(pagetitle)$$pagetitle$$endif$</title>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<link rel="stylesheet" href="_css/chrome.css" />
		<link rel="stylesheet" href="../_css/chrome.css" />
		<link rel="stylesheet" href="../../_css/chrome.css" />
		<link rel="stylesheet" href="../../../_css/chrome.css" />
		<script src="_js/jquery-1.4.2.min.js" type="text/javascript"></script>
		<script src="../_js/jquery-1.4.2.min.js" type="text/javascript"></script>
		<script src="../../_js/jquery-1.4.2.min.js" type="text/javascript"></script>
		<script src="../../../_js/jquery-1.4.2.min.js" type="text/javascript"></script>
		<script src="_js/doc.js" type="text/javascript"></script>
		<script src="../_js/doc.js" type="text/javascript"></script>
		<script src="../../_js/doc.js" type="text/javascript"></script>
		<script src="../../../_js/doc.js" type="text/javascript"></script>
	</head>
	<body>
		<div id="content">
    
    <h1 id="account-manager">
      Account Manager
    </h1><img src="/images/AcctManagerComponents.jpg">
    <p>
      The Account Manager service (<code>com.palm.service.accounts</code>) provides central account and credentials management on the device. Synergy services are services on the webOS message bus that provide a connection to an outside data source (i.e., for log in and syncing) and manage the caching of credentials and configuration data on the device. To interact with the Accounts service, Synergy services need to register an Account template file (read at Account service start-up) that contains callbacks and metadata. Synergy applications can use the Account service when interacting with external account <strong><em>providers</em></strong> such as Facebook, Google, Yahoo, and LinkedIn. Third-party applications can use the service to interface with their own providers and integrate with the Palm Accounts app which provides a unified and standard Account UI.
    </p>
    <p>
      Providers give users <em><strong>capabilities</strong></em> such as contacts, calendar, blogging, email, and so on. For a single user, each of these capabilities can have its own provider account. In addition, each capability can have its own protocol <em><strong>implementation</strong></em>, such as Gdata, Exchange, POP, IMAP, and so on.
    </p>
    <p>
      webOS supports a number of built-in providers and their capabilities which HP or 3rd parties may extend in the future. Providers determine the types of accounts and credentials that exist on the device which can vary by capability. Account objects stored on the device (proxies for real provider accounts) are a combination of credentials for a particular provider, with one or more capabilities enabled. For a given provider and user, only one Account object can exist in the db8 database. Using the Account service methods, apps and services can list account information, create new accounts, and alter existing accounts.
    </p>
    <p>
      <strong>In this section</strong>
    </p>
    <p>
      To integrate with the Account Manager service, applications need to create, configure or incorporate the following:
    </p>
    <ul>
      <li>
        <p>
          Design Points -- Things to keep in mind when you are developing your Account and Synergy services.
        </p>
      </li>
      <li>
        <p>
          Account Manager Service Interface (APIs) -- The Accounts service (<code>com.palm.service.accounts</code>) allows users to list, create, and alter localized accounts. Note that this applies to Account objects in the db8 database on the device, not creating or deleting an actual provider (Facebook, Google, etc.) account. The user must already have a provider account.
        </p>
        <p>
          Once one capability is enabled, the Account service can enable all provider capabilities for the user. For example: if the user has Google accounts for contacts, messaging, mail, and calendar, the Accounts service can enable all of them.
        </p>
        <p>
          This service also handles the reading and writing of account credentials and other sensitive data. See the Account Manager API for more information.
        </p>
      </li>
      <li>
        <p>
          Synergy Service -- Your app needs to provide a Synergy service on the bus that implements a connection with an outside data source. This service can also implement methods the Account Manager calls when an account is created or altered.
        </p>
      </li>
      <li>
        <p>
          Account Template -- Your Synergy service needs to register an Account template file containing callbacks and metadata with the Accounts service. The Accounts service invokes these callbacks to validate credentials and notify the service about account creation or modification. This file is read and registered each time the Accounts service starts up.
        </p>
        <p>
          For third parties installing a service in a packaged file, your template file must be named <code>account_template.json</code>. See the <a href="/reference/data-types/account-manager.html#Template">Template data type</a> for more information about this file's configuration.
        </p>
      </li>
      <li>
        <p>
          Accounts UI library -- Your JavaScript app should include the Accounts UI library (<code>accounts.ui</code>) to handle common UI tasks such as launch screens, account preferences, and account listings. This library provides the baseline functionality for the standalone Accounts app.
        </p>
      </li>
      <li>
        <p>
          Custom Validator -- This is optional. Most account templates can utilize the standard username/password Accounts UI when logging in. If not, the Accounts Framework allows template authors to specify a custom UI to display in lieu of the standard login UI.
        </p>
      </li>
    </ul>
    <p>
      See also: <a href="/reference/data-types/account-manager.html">Account Manager Data Types</a> and <a href="creating-synergy-contacts-package.html">Creating a Synergy Contacts Package</a>.
    </p>
    <p>
      <a name="DesignPoints" id="DesignPoints">&#160;</a>
    </p>
    <hr>
    <h2 id="design-points">
      Design points
    </h2>
    <ul>
      <li>
        <p>
          The Accounts preferences app and all PIM (Personal Information Manager) apps share an Accounts UI component. PIM apps need only implement their app-specific preferences UI (e.g. calendar color).
        </p>
      </li>
      <li>
        <p>
          The Accounts UI will talk to the Accounts service (<code>com.palm.service.accounts</code>) to coordinate account creation, modification, and removal.
        </p>
      </li>
      <li>
        <p>
          The Accounts Service triggers various procedures for account actions, including:
        </p>
        <ul>
          <li>On account creation, begins initial syncs.
          </li>
          <li>On capability removal, deletes PIM data.
          </li>
          <li>On username/password change, calls all validators to generate custom authorization tokens.
          </li>
        </ul>
      </li>
      <li>
        <p>
          The Accounts Service acts as a proxy for credentials read/write access for white-listed services. For example: the IMAP service asks the account service for the gmail authorization token when doing a gmail sync.
        </p>
      </li>
    </ul><br>
    <hr>
    <h2 id="account-manager-service-interface-apis">
      Account Manager Service Interface (APIs)
    </h2>
    <p>
      You can call Activity Manager methods asynchronously in one of two ways.
    </p>
    <ol style="list-style-type: decimal">
      <li>
        <p>
          Through the &quot;serviceRequest&quot; function, which takes 2 parameters:
        </p>
        <ol style="list-style-type: decimal">
          <li>The Account Manager URI (Uniform Resource Identifier)
          </li>
          <li>A JSON (JavaScript Object Notation) object containing parameters, callback functions, and other data.
          </li>
        </ol>
      </li>
    </ol>
    <blockquote>
      <pre>
<code> this.controller.serviceRequest(&quot;palm://com.palm.service.accounts/&quot;, {
    method: &quot;getAccountInfo&quot;,
    parameters: {
        &quot;accountId&quot;: &quot;2+PO&quot;
    },
    onSuccess: function(e) { Mojo.Log.info(&quot;getAccountInfo success, Account=&quot;+JSON.stringify(e));},
    onFailure: function(e) { Mojo.Log.info(&quot;getAccountInfo failure Err code=&quot; + e.errorCode + &quot;Err text=&quot; + e.text); }
 });
</code>
</pre>
    </blockquote>
    <ol start="2" style="list-style-type: decimal">
      <li>
        <p>
          Through the new Foundation library API for calling Palm services.
        </p>
        <p>
          Palm's JavaScript Foundation libraries are a loadable framework that both Mojo and JavaScript service applications can use.
        </p>
        <p>
          For example:
        </p>
      </li>
    </ol>
    <blockquote>
      <pre>
<code> var libraries = MojoLoader.require({ name: &quot;foundations&quot;, version: &quot;1.0&quot; });
 var PalmCall = libraries[&quot;foundations&quot;].Comms.PalmCall;
 PalmCall.call(&quot;palm://com.palm.service.accounts/&quot;, &quot;getAccountInfo&quot;, {&quot;accountId&quot;: &quot;2+PO&quot;});
</code>
</pre>
    </blockquote>
    <pre>
<code>This also requires your app to have the following two tags in your index.html file:
</code>
</pre>
    <blockquote>
      <pre>
<code> &lt;script src=&quot;/usr/palm/frameworks/mojo/mojo.js&quot; type=&quot;text/javascript&quot; x-mojo-version=&quot;1&quot;&gt;&lt;/script&gt;        
 &lt;script src=&quot;/usr/palm/frameworks/mojoloader.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;
</code>
</pre>
    </blockquote>
    <p>
      Depending on outcome, both calls return a JSON result indicating success or failure. Your code can then parse the result. Your app needs to take into account the call's asynchronous nature (results may be delayed) and not block user interaction while awaiting results.
    </p>
    <h3 id="about-json">
      About JSON
    </h3>
    <p>
      JSON is a lightweight data-interchange text format based on a subset of the JavaScript programming language that is easy for humans to read and write and for machines to parse and generate. Like XML, JSON contains name/value pair collections and ordered list of values (i.e., arrays).
    </p>
    <p>
      For more information on JSON, see the following websites:
    </p>
    <ul>
      <li>
        <a href="http://www.json.org/">JSON objects, values and format</a>
      </li>
      <li>
        <a href="http://tools.ietf.org/html/draft-zyp-json-schema-02">JSON schemas</a>
      </li>
    </ul>
    <p>
      A primer on how JSON data objects are formatted is beyond the scope of this document—consult the two links above for more information. However, in brief:
    </p>
    <ul>
      <li>Curly brackets ('{', '}') are used to enclose objects.
      </li>
      <li>Angle brackets ('[', ']') are used to enclose arrays.
      </li>
      <li>Colons (':') are used as delimiters in name/value pairs.
      </li>
      <li>Quotes (&quot;) are used for string values. Numeric values are not quoted.
      </li>
    </ul>
    <h3 id="account-manager-service-api">
      Account Manager Service API:
    </h3>
    <ul>
      <li>
        <a href="#createAccount">createAccount</a>—Create an account object in the db8 database.
      </li>
      <li>
        <a href="#deleteAccount">deleteAccount</a>—Delete an account object in the db8 database.
      </li>
      <li>
        <a href="#getAccountInfo">getAccountInfo</a>—Retrieve a specific account object from the db8 database.
      </li>
      <li>
        <a href="#modifyAccount">modifyAccount</a>—Modify an account object in the db8 database.
      </li>
    </ul>
    <p>
      <a name="createAccount" id="createAccount">&#160;</a>
    </p>
    <hr>
    <h3 id="createaccount">
      createAccount
    </h3>
    <p>
      Creates an Account object in the db8 database that serves as a proxy for a real provider (i.e., Facebook, Google) account. The caller can specify the provider capabilities (email, calendar, etc.) they want to enable for the account. Callers can pass configuration data and credentials for one or more provider accounts. An account can have multiple named credentials objects. For example, it could have objects named &quot;common&quot;, &quot;smtp&quot;, and &quot;imap&quot;. With these, the SMTP and IMAP services could keep their own authorization tokens, and all other Synergy services could use the &quot;common&quot; credentials. Typically, credential and configuration information is returned from a <a href="#validator">validate user login API</a>. Configuration information is passed to the Synergy service's <a href="#onCreate">onCreate</a> method and credentials are kept in encrypted storage.
    </p>
    <p>
      This method does the initial writing of account credentials to encrypted storage; after this, you can use the writeCredentials method to alter them.
    </p>
    <p>
      To avoid duplicates, usernames should be &quot;normalized,&quot; that is, incomplete usernames (i.e., &quot;johndoe&quot;) should be turned into fully-qualified, unambigous usernames (i.e., &quot;johndoe@gmail.com&quot;).
    </p>
    <h4 id="syntax">
      Syntax
    </h4>
    <pre>
   {
       "templateId"   : string,
       "capabilityProviders" : [ {
                                     "id"         : string,
                                     "capability" : string
                                  }
                                 ],
        "username"     : string,
        "alias"        : string,
        "credentials"  : {
                           &lt;any string&gt; : CredentialsObj object,
                            ...
                         },
        "config"       : any,
        "sync"         : boolean
   }
</pre>
    <h4 id="parameters">
      Parameters
    </h4>
    <table border="1" cellpadding="5" cellspacing="5">
      <thead>
        <tr bgcolor="lightgrey">
          <th width="220">
            Argument
          </th>
          <th>
            Required
          </th>
          <th width="160">
            Type
          </th>
          <th width="400">
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            templateId
          </td>
          <td>
            Yes
          </td>
          <td>
            string
          </td>
          <td>
            ID of the template file (i.e., &quot;com.palm.google&quot;) stored in <code>/usr/palm/public/accounts/</code> for the account's Synergy service. See the Template data type for more information.
          </td>
        </tr>
        <tr>
          <td>
            capabilityProviders
          </td>
          <td>
            No
          </td>
          <td>
            array of inline objects
          </td>
          <td>
            See two elements below.
          </td>
        </tr>
        <tr>
          <td style="padding-left:30px">
            id
          </td>
          <td>
            No
          </td>
          <td>
            string
          </td>
          <td>
            Capability ID in template, i.e., &quot;com.palm.gdata.calendar&quot;
          </td>
        </tr>
        <tr>
          <td style="padding-left:30px">
            capability
          </td>
          <td>
            No
          </td>
          <td>
            string
          </td>
          <td>
            Capability name, i.e., &quot;CONTACTS&quot;
          </td>
        </tr>
        <tr>
          <td>
            username
          </td>
          <td>
            Yes
          </td>
          <td>
            string
          </td>
          <td>
            User name.
          </td>
        </tr>
        <tr>
          <td>
            alias
          </td>
          <td>
            No
          </td>
          <td>
            string
          </td>
          <td>
            Alias name. Account name in UI.
          </td>
        </tr>
        <tr>
          <td>
            credentials
          </td>
          <td>
            Yes
          </td>
          <td>
            CredentialsObj object(s)
          </td>
          <td>
            One or more named credential objects. See example.
          </td>
        </tr>
        <tr>
          <td>
            config
          </td>
          <td>
            Yes
          </td>
          <td>
            any
          </td>
          <td>
            Opaque config objects passed to Synergy service.
          </td>
        </tr>
        <tr>
          <td>
            sync
          </td>
          <td>
            No
          </td>
          <td>
            boolean
          </td>
          <td>
            Automatic backup flag. Default is <code>true</code>.
          </td>
        </tr>
      </tbody>
    </table>
    <h4 id="returns">
      Returns
    </h4>
    <pre>
{
    "returnValue" : boolean,
    "errorCode"   : string,
    "errorText"   : string,
    "result"      : Account 
}
</pre>
    <table border="1" cellpadding="5" cellspacing="5">
      <thead>
        <tr bgcolor="lightgrey">
          <th>
            Argument
          </th>
          <th>
            Required
          </th>
          <th>
            Type
          </th>
          <th width="400">
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            returnValue
          </td>
          <td>
            Yes
          </td>
          <td>
            boolean
          </td>
          <td>
            <code>true</code> (success) or <code>false</code> (failure).
          </td>
        </tr>
        <tr>
          <td>
            errorCode
          </td>
          <td>
            No
          </td>
          <td>
            string
          </td>
          <td>
            Returned on failure.
          </td>
        </tr>
        <tr>
          <td>
            errorText
          </td>
          <td>
            No
          </td>
          <td>
            string
          </td>
          <td>
            Returned on failure. Text describing error.
          </td>
        </tr>
        <tr>
          <td>
            result
          </td>
          <td>
            Yes
          </td>
          <td>
            Account
          </td>
          <td>
            Created Account object.
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      <strong>Example with multiple credential objects</strong>
    </p>
    <pre>
<code>   this.controller.serviceRequest(&quot;palm://com.palm.service.accounts/&quot;, {
      method: &quot;createAccount&quot;,
      parameters: {&quot;templateId&quot;          : &quot;com.palm.sample&quot;,
                   &quot;capabilityProviders&quot; : [{&quot;id&quot;:&quot;com.palm.sample.contacts&quot;, &quot;capability&quot;:&quot;CONTACTS&quot;}],
                   &quot;username&quot;            : &quot;Souffle&quot;,
                   &quot;alias&quot;               : &quot;puffy&quot;,
                   &quot;credentials&quot;         : {&quot;common&quot;:{ &quot;password&quot; : &quot;laddw99&quot;, &quot;authToken&quot;:&quot;8ukkk9##99&quot;}, &quot;smtp&quot;:{ &quot;password&quot; : &quot;lawyer99&quot;, &quot;authToken&quot;:&quot;8u0009##99&quot;}},
                   &quot;config&quot;              : {  &quot;ip&quot;:&quot;12.225.172.8&quot; }
        },
     onSuccess: function(e) { Mojo.Log.info(&quot;Account object = &quot;+JSON.stringify(e)); },
     onFailure: function(e) { Mojo.Log.info(&quot;createAccount failure: errorCode = &quot; + e.errorCode + &quot;, errorText = &quot;+e.errorText); }      
  });
</code>
</pre>
    <p>
      <a name="deleteAccount" id="deleteAccount">&#160;</a>
    </p>
    <hr>
    <h3 id="deleteaccount">
      deleteAccount
    </h3>
    <p>
      Given an account ID, deletes an account object in db8. The account's Synergy service is notified through its <a href="#onDelete"><code>onDelete</code></a> and <a href="#onEnabled"><code>onEnabled</code></a> (with &quot;enabled = false&quot;) methods. The Synergy should use the onEnabled method to clean up all sync data associated with the account.
    </p>
    <h4 id="syntax-1">
      Syntax
    </h4>
    <pre>
<code> {
    &quot;accountID&quot;  : string
 }
</code>
</pre>
    <h4 id="parameter">
      Parameter
    </h4>
    <table border="1" cellpadding="5" cellspacing="5">
      <thead>
        <tr bgcolor="lightgrey">
          <th>
            Argument
          </th>
          <th>
            Required
          </th>
          <th>
            Type
          </th>
          <th width="400">
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            accountId
          </td>
          <td>
            Yes
          </td>
          <td>
            string
          </td>
          <td>
            db8 Account ID
          </td>
        </tr>
      </tbody>
    </table>
    <h4 id="returns-1">
      Returns
    </h4>
    <pre>
<code>{
    &quot;returnValue&quot; : boolean,
    &quot;errorCode&quot;   : string,
    &quot;errorText&quot;   : string      
}
</code>
</pre>
    <table border="1" cellpadding="5" cellspacing="5">
      <thead>
        <tr bgcolor="lightgrey">
          <th>
            Argument
          </th>
          <th>
            Required
          </th>
          <th>
            Type
          </th>
          <th width="400">
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            returnValue
          </td>
          <td>
            Yes
          </td>
          <td>
            boolean
          </td>
          <td>
            <code>true</code> (success) or <code>false</code> (failure)
          </td>
        </tr>
        <tr>
          <td>
            errorCode
          </td>
          <td>
            No
          </td>
          <td>
            string
          </td>
          <td>
            Returned on failure.
          </td>
        </tr>
        <tr>
          <td>
            errorText
          </td>
          <td>
            No
          </td>
          <td>
            string
          </td>
          <td>
            Returned on failure. Text describing error.
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      <strong>Example</strong>
    </p>
    <pre>
<code>   this.controller.serviceRequest(&quot;palm://com.palm.service.accounts/&quot;, {
      method: &quot;deleteAccount&quot;,
      parameters: {
            &quot;accountId&quot;: &quot;2+PO&quot;
        },
     onSuccess: function(){ Mojo.Log.info(&quot;deleteAccount success&quot;); },
     onFailure: function(e) { Mojo.Log.info(&quot;deleteAccount failure errorCode = &quot; + e.errorCode + &quot; errorText = &quot;+e.errorText); }                
  });
</code>
</pre>
    <p>
      <a name="getAccountInfo" id="getAccountInfo">&#160;</a>
    </p>
    <hr>
    <h3 id="getaccountinfo">
      getAccountInfo
    </h3>
    <p>
      Given an account ID, returns a db8 Account object combined with a Template object.
    </p>
    <h4 id="syntax-2">
      Syntax
    </h4>
    <pre>
<code>{
   &quot;accountId&quot; : string
}
</code>
</pre>
    <h4 id="parameters-1">
      Parameters
    </h4>
    <table border="1" cellpadding="5" cellspacing="5">
      <thead>
        <tr bgcolor="lightgrey">
          <th>
            Argument
          </th>
          <th>
            Required
          </th>
          <th>
            Type
          </th>
          <th width="400">
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            accountId
          </td>
          <td>
            Yes
          </td>
          <td>
            string
          </td>
          <td>
            db8 account ID.
          </td>
        </tr>
      </tbody>
    </table>
    <h4 id="returns-2">
      Returns
    </h4>
    <pre>
{
    "returnValue" : boolean,
    "errorCode"   : string,
    "errorText"   : string, 
    "result"      : Combined Account and Template object
}
</pre>
    <table border="1" cellpadding="5" cellspacing="5">
      <thead>
        <tr bgcolor="lightgrey">
          <th>
            Argument
          </th>
          <th>
            Required
          </th>
          <th>
            Type
          </th>
          <th width="400">
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            returnValue
          </td>
          <td>
            Yes
          </td>
          <td>
            boolean
          </td>
          <td>
            <code>true</code> (success) or <code>false</code> (failure).
          </td>
        </tr>
        <tr>
          <td>
            errorCode
          </td>
          <td>
            No
          </td>
          <td>
            string
          </td>
          <td>
            Returned on failure.
          </td>
        </tr>
        <tr>
          <td>
            errorText
          </td>
          <td>
            No
          </td>
          <td>
            string
          </td>
          <td>
            Returned on failure. Text describing error.
          </td>
        </tr>
        <tr>
          <td>
            result
          </td>
          <td>
            No
          </td>
          <td>
            Combined Account and Template object
          </td>
          <td>
            Account object combined with Template object.
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      <strong>Example</strong>
    </p>
    <pre>
<code>   this.controller.serviceRequest(&quot;palm://com.palm.service.accounts/&quot;, {
      method: &quot;getAccountInfo&quot;,
      parameters: {
            &quot;accountId&quot;: &quot;2+31&quot;,
        },
     onSuccess: function(e) { Mojo.Log.info(&quot;getAccountInfo success, Account=&quot;+JSON.stringify(e));},
     onFailure: function(e) { Mojo.Log.info(&quot;getAccountInfo failure errorCode = &quot; + e.errorCode + &quot; errorText = &quot;+e.errorText); }
  });
</code>
</pre>
    <p>
      <strong>Example Output</strong>
    </p>
    <pre>
<code>Account= 
{&quot;result&quot;:{&quot;_kind&quot;: &quot;com.palm.account:1&quot;,
        &quot;_id&quot;: &quot;2+31&quot;,
        &quot;_rev&quot;: 258,
        &quot;_sync&quot;: true,
        &quot;beingDeleted&quot;: false,
        &quot;capabilityProviders&quot;: [
            {
                &quot;_id&quot;: &quot;2+32&quot;,
                &quot;capability&quot;: &quot;CONTACTS&quot;,
                &quot;id&quot;: &quot;com.palm.palmprofile.contacts&quot;,
                &quot;db_kinds&quot;: {
                    &quot;contact&quot;: &quot;com.palm.contact.palmprofile:1&quot;
                }
            },
            {
                &quot;_id&quot;: &quot;2+33&quot;,
                &quot;capability&quot;: &quot;CALENDAR&quot;,
                &quot;id&quot;: &quot;com.palm.palmprofile.calendar&quot;
            },
            {
                &quot;_id&quot;: &quot;2+34&quot;,
                &quot;capability&quot;: &quot;TASKS&quot;,
                &quot;id&quot;: &quot;com.palm.palmprofile.tasks&quot;
            },
            {
                &quot;_id&quot;: &quot;2+35&quot;,
                &quot;capability&quot;: &quot;MEMOS&quot;,
                &quot;id&quot;: &quot;com.palm.palmprofile.memos&quot;
            },
            {
                &quot;_id&quot;: &quot;2+36&quot;,
                &quot;capability&quot;: &quot;MESSAGING&quot;,
                &quot;id&quot;: &quot;com.palm.palmprofile.sms&quot;,
                &quot;capabilitySubtype&quot;: &quot;SMS&quot;,
                &quot;loc_name&quot;: &quot;SMS Account&quot;,
                &quot;loc_shortName&quot;: &quot;Text&quot;,
                &quot;icon&quot;: {
                    &quot;loc_32x32&quot;: &quot;\/usr\/palm\/public\/accounts\/com.palm.palmprofile\/images\/sms-32x32.png&quot;,
                    &quot;loc_48x48&quot;: &quot;\/usr\/palm\/public\/accounts\/com.palm.palmprofile\/images\/sms-48x48.png&quot;,
                    &quot;splitter&quot;: &quot;\/usr\/palm\/public\/accounts\/com.palm.palmprofile\/images\/sms-32x32.png&quot;
                }
            }
        ],
        &quot;templateId&quot;: &quot;com.palm.palmprofile&quot;,
        &quot;username&quot;: &quot;Dr. Skipped Firstuse&quot;,
        &quot;loc_name&quot;: &quot;Palm Profile&quot;,
        &quot;icon&quot;: {
            &quot;loc_32x32&quot;: &quot;\/usr\/palm\/public\/accounts\/com.palm.palmprofile\/images\/mypalm-32x32.png&quot;,
            &quot;loc_48x48&quot;: &quot;\/usr\/palm\/public\/accounts\/com.palm.palmprofile\/images\/mypalm-48x48.png&quot;
        }
    }}
</code>
</pre>
    <p>
      <a name="modifyAccount" id="modifyAccount">&#160;</a>
    </p>
    <hr>
    <h3 id="modifyaccount">
      modifyAccount
    </h3>
    <p>
      Can be used to change Account object properties including capabilities. Properties are overwritten.
    </p>
    <p>
      If you add or delete a capability, the capability's Synergy service <a href="#onEnabled">onEnabled</a> method is called.
    </p>
    <h4 id="syntax-3">
      Syntax
    </h4>
    <pre>
<code>{
   &quot;accountId&quot;  : string,
   &quot;object&quot;     : any
}
</code>
</pre>
    <h4 id="parameters-2">
      Parameters
    </h4>
    <table border="1" cellpadding="5" cellspacing="5">
      <thead>
        <tr bgcolor="lightgrey">
          <th>
            Argument
          </th>
          <th>
            Required
          </th>
          <th>
            Type
          </th>
          <th width="400">
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            accountId
          </td>
          <td>
            Yes
          </td>
          <td>
            string
          </td>
          <td>
            db8 account ID.
          </td>
        </tr>
        <tr>
          <td>
            object
          </td>
          <td>
            Yes
          </td>
          <td>
            any
          </td>
          <td>
            Account properties and new values.
          </td>
        </tr>
      </tbody>
    </table>
    <h4 id="returns-3">
      Returns
    </h4>
    <pre>
<code>{
   &quot;returnValue&quot;  : boolean,
   &quot;errorCode&quot;    : string,
   &quot;errorText&quot;    : string   
}
</code>
</pre>
    <table border="1" cellpadding="5" cellspacing="5">
      <thead>
        <tr bgcolor="lightgrey">
          <th>
            Argument
          </th>
          <th>
            Required
          </th>
          <th>
            Type
          </th>
          <th width="400">
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            returnValue
          </td>
          <td>
            Yes
          </td>
          <td>
            boolean
          </td>
          <td>
            <code>true</code> (success) or <code>false</code> (failure)
          </td>
        </tr>
        <tr>
          <td>
            errorCode
          </td>
          <td>
            No
          </td>
          <td>
            string
          </td>
          <td>
            Returned on failure.
          </td>
        </tr>
        <tr>
          <td>
            errorText
          </td>
          <td>
            No
          </td>
          <td>
            string
          </td>
          <td>
            Returned on failure. Text describing error.
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      <strong>Example</strong>
    </p>
    <pre>
<code>   this.controller.serviceRequest(&quot;palm://com.palm.service.accounts/&quot;, {
      method: &quot;modifyAccount&quot;,
      parameters: {&quot;accountId&quot;:&quot;2+Ph&quot;,
                   &quot;object&quot;: {&quot;username&quot;:&quot;ChuckWagon99&quot;, &quot;alias&quot;: &quot;huggybeer&quot;}},
     onSuccess: function(){ Mojo.Log.info(&quot;modifyAccount success&quot;); },
     onFailure: function(e) { Mojo.Log.info(&quot;modifyAccount failure errorCode = &quot; + e.errorCode + &quot; errorText = &quot;+e.errorText); }        
  });
</code>
</pre>
    <p>
      <a name="SynergyService" id="SynergyService">&#160;</a>
    </p>
    <hr>
    <h2 id="synergy-service">
      Synergy Service
    </h2>
    <p>
      A Synergy service that interacts with the Account service needs to implement a number of callbacks that are invoked to validate login or when an account object in db8 storage is created or altered. These are named in the Synergy service's Account template file that the Account service reads on start-up. The Account service invokes these callbacks to validate credentials and notify the Synergy service about account creation or modification.
    </p>
    <p>
      <strong>Note:</strong> Third-party services that interact with the Account Manager are required to be packaged (via <code>palm-package</code>) with an <code>account-template.json</code> file containing a template object along with accompanying metadata such as account icons and localized text.
    </p>
    <p>
      Most Synergy services will want to store account-wide configuration data upon account creation, and clean up that data upon deletion. Creation is not the time to start syncing, and deletion is not the time to stop syncing.<br>
      When a capability is enabled, Synergy services should start syncing and schedule future syncs with the Activity Manager. When a capability is disabled, Synergy services should stop syncing, delete associated data, stop future syncs, and delete sync state.
    </p>
    <p>
      Except where noted, all callbacks are per-capability, meaning that you can either elect to have one capability provider handle everything, or each capability provider can implement its own behaviors (or a mix of the two).
    </p>
    <p>
      For each account capability, you can have the same or different callbacks. See the capability data type for required capability implementation fields.
    </p>
    <h3 id="synergy-service-configuration-objects">
      Synergy Service Configuration Objects
    </h3>
    <p>
      Validators and custom validation UI can emit a configuration object that can be used to contain server settings and other account-wide, capability-independent configuration data. Unlike credentials, this is not kept in encrypted storage. Synergy services can read this data to know how to sync and validators and custom validation UI can emit new values to modify this data when the user changes login info.
    </p>
    <p>
      Synergy services should use this for data that needs to persist even after a capability has been disabled (in case it is ever re-enabled), and delete it when the associated account is deleted (<code>onDelete</code> is called). Configuration data should not be used to store sync state or other information that should be deleted when a capability is disabled.
    </p>
    <p>
      Synergy services are expected to persist configuration data when they are passed in to <code>onCreate</code> and clean them up in <code>onDelete</code>. Multiple services supporting different capabilities for a single account should cooperate in managing configuration objects—either each service could maintain its own portion, or one service could maintain it all.
    </p>
    <h3 id="required-directory-structure">
      Required Directory Structure
    </h3>
    <p>
      Synergy services should use the following hierarchy to organize device files. The root is assumed to be the first party root (<code>&quot;/usr/palm/public/&quot;</code>) or third-party root (<code>&quot;/media/cryptofs/apps/usr/palm/accounts&quot;</code>).
    </p>
    <pre>
<code>com.x.y/
    com.x.y.json
    images/
        xy-32x32.png
        xy-48x48.png
    resources/
        es_US/
            com.x.y.json (localized complete copy of base .json file)
            images/ (for localized images)
                xy-32x32.png
                xy-48x48.png
</code>
</pre>
    <h3 id="account-manager-invoked-synergy-service-callbacks">
      Account Manager Invoked Synergy Service Callbacks
    </h3>
    <p>
      Note that the names listed below are <strong>NOT</strong> the names of methods your Synergy service implements, they are field names in a capability object. Bus address and method names are the value for these fields, which can be anything you want.
    </p>
    <ul>
      <li>
        <p>
          <a href="#onCapabilitiesChanged">onCapabilitiesChanged</a>—Called when account capabilities (email, blog, calendar, etc.) change. This is implemented at the top-level, not per capability.
        </p>
      </li>
      <li>
        <p>
          <a href="#onCreate">onCreate</a>—Called when <a href="#createAccount">account created.</a>
        </p>
      </li>
      <li>
        <p>
          <a href="#onDelete">onDelete</a>—Called when <a href="#deleteAccount">account deleted.</a>
        </p>
      </li>
      <li>
        <p>
          <a href="#onEnabled">onEnabled</a>—Called when each capability is enabled or disabled which can happen when an account is created, deleted, or <a href="#modifyAccount">modified.</a>
        </p>
      </li>
      <li>
        <p>
          <a href="#validator">validator</a>—Called to validate username/password and generate credentials and configuration information.
        </p>
      </li>
      <li>
        <p>
          <a href="#errors">Synergy Service Error Codes</a>—Error codes Synergy services should return on failure.
        </p>
      </li>
    </ul>
    <p>
      <a name="onCapabilitiesChanged" id="onCapabilitiesChanged">&#160;</a>
    </p>
    <hr>
    <h3 id="oncapabilitieschanged">
      onCapabilitiesChanged
    </h3>
    <p>
      The Account Manager calls this Synergy service method when an account's capability (email, blogging, contacts, etc.) is enabled or disabled. This can happen during initial account creation or when an account is subsequently modified (<a href="#createAccount">createAccount</a> or <a href="#modifyAccount">modifyAccount</a>). The new state of enabled capability providers is passed. This is useful for templates where a single unified Synergy service handles all syncing; in that case, it's easier to re-do all syncing in one step rather than using multiple 'onEnabled` handlers.
    </p>
    <h4 id="syntax-4">
      Syntax
    </h4>
    <pre>
<code>{
   &quot;accountId&quot;           : string,
   &quot;capabilityProviders&quot; : [ {
                                id      : string,
                                enabled : boolean
                              }
                           ]
}
</code>
</pre>
    <h4 id="parameters-3">
      Parameters
    </h4>
    <table border="1" cellpadding="5" cellspacing="5">
      <thead>
        <tr bgcolor="lightgrey">
          <th>
            Argument
          </th>
          <th>
            Required
          </th>
          <th>
            Type
          </th>
          <th width="400">
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            accountId
          </td>
          <td>
            Yes
          </td>
          <td>
            string
          </td>
          <td>
            db8 account ID.
          </td>
        </tr>
        <tr>
          <td>
            capabilityProviders
          </td>
          <td>
            Yes
          </td>
          <td>
            array of inline objects
          </td>
          <td>
            Array of object identifying capabilities and if they are enabled or disabled.
          </td>
        </tr>
        <tr>
          <td style="padding-left:30px">
            id
          </td>
          <td>
            Yes
          </td>
          <td>
            string
          </td>
          <td>
            Capability ID, i.e., &quot;com.palm.facebook.calendar&quot;.
          </td>
        </tr>
        <tr>
          <td style="padding-left:30px">
            enabled
          </td>
          <td>
            Yes
          </td>
          <td>
            boolean
          </td>
          <td>
            Is capability enabled or disabled flag.
          </td>
        </tr>
      </tbody>
    </table>
    <h4 id="returns-4">
      Returns
    </h4>
    <table border="1" cellpadding="5" cellspacing="5">
      <thead>
        <tr bgcolor="lightgrey">
          <th>
            Argument
          </th>
          <th>
            Type
          </th>
          <th width="400">
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            returnValue
          </td>
          <td>
            boolean
          </td>
          <td>
            <code>true</code> (success) or <code>false</code> (failure)
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      <a name="onCreate" id="onCreate">&#160;</a>
    </p>
    <hr>
    <h3 id="oncreate">
      onCreate
    </h3>
    <p>
      The Account Manager calls this Synergy service method when an account is created. After this, the Account Manager calls the Synergy service's<br>
      <a href="#onCapabilitiesChanged">onCapabilitiesChanged</a> and <a href="#onEnabled">onEnabled</a> methods for each capability. When called, these handlers should save any passed configuration information.
    </p>
    <p>
      Note that <code>onCreate</code> is not called again for restored accounts as it is assumed the data has been recreated from backup. Therefore, any <code>onCreate</code> persisted data must be backed up to restore the account properly.
    </p>
    <h4 id="syntax-5">
      Syntax
    </h4>
    <pre>
<code>{
   &quot;accountId&quot; : string,
   &quot;config&quot;    :  any
}
</code>
</pre>
    <h4 id="parameters-4">
      Parameters
    </h4>
    <table border="1" cellpadding="5" cellspacing="5">
      <thead>
        <tr bgcolor="lightgrey">
          <th>
            Argument
          </th>
          <th>
            Required
          </th>
          <th>
            Type
          </th>
          <th width="400">
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            accountId
          </td>
          <td>
            Yes
          </td>
          <td>
            string
          </td>
          <td>
            db8 account ID.
          </td>
        </tr>
        <tr>
          <td>
            config
          </td>
          <td>
            No
          </td>
          <td>
            any
          </td>
          <td>
            Opaque configuration objects containing any information the Synergy service wants such as IP addresses, ports, etc.
          </td>
        </tr>
      </tbody>
    </table>
    <h4 id="returns-5">
      Returns
    </h4>
    <table border="1" cellpadding="5" cellspacing="5">
      <thead>
        <tr bgcolor="lightgrey">
          <th>
            Argument
          </th>
          <th>
            Type
          </th>
          <th width="400">
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            returnValue
          </td>
          <td>
            boolean
          </td>
          <td>
            <code>true</code> (success) or <code>false</code> (false)
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      <a name="onDelete" id="onDelete">&#160;</a>
    </p>
    <hr>
    <h3 id="ondelete">
      onDelete
    </h3>
    <p>
      The Account Manager calls this when an entire account is being deleted. All capability providers that declared a handler are called. Handlers should delete any account-wide configuration. To proceed, all <code>onDelete</code> calls must succeed.
    </p>
    <h4 id="syntax-6">
      Syntax
    </h4>
    <pre>
<code>{
   &quot;accountId&quot; : string
}
</code>
</pre>
    <h4 id="parameters-5">
      Parameters
    </h4>
    <table border="1" cellpadding="5" cellspacing="5">
      <thead>
        <tr bgcolor="lightgrey">
          <th>
            Argument
          </th>
          <th>
            Required
          </th>
          <th>
            Type
          </th>
          <th width="400">
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            accountId
          </td>
          <td>
            Yes
          </td>
          <td>
            string
          </td>
          <td>
            db8 account ID.
          </td>
        </tr>
      </tbody>
    </table>
    <h4 id="returns-6">
      Returns
    </h4>
    <table border="1" cellpadding="5" cellspacing="5">
      <thead>
        <tr bgcolor="lightgrey">
          <th>
            Argument
          </th>
          <th>
            Type
          </th>
          <th width="400">
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            returnValue
          </td>
          <td>
            boolean
          </td>
          <td>
            <code>true</code> (success) or <code>false</code> (failure)
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      <a name="onEnabled" id="onEnabled">&#160;</a>
    </p>
    <hr>
    <h3 id="onenabled">
      onEnabled
    </h3>
    <p>
      The Account Manager call this Synergy service method when a capability is enabled or disabled. When enabled, notified Synergy services should start a sync and schedule future syncs. When disabled, notified Synergy services should disable syncing and delete associated data. Account-wide configuration should remain on disk, and only deleted when <code>onDelete</code> is called.
    </p>
    <h4 id="syntax-7">
      Syntax
    </h4>
    <pre>
<code>{
   &quot;enabled&quot;              : boolean,
   &quot;accountId&quot;            : string,
   &quot;capabilityProviderId&quot; : string
}
</code>
</pre>
    <h4 id="parameters-6">
      Parameters
    </h4>
    <table border="1" cellpadding="5" cellspacing="5">
      <thead>
        <tr bgcolor="lightgrey">
          <th>
            Argument
          </th>
          <th>
            Required
          </th>
          <th>
            Type
          </th>
          <th width="400">
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            enabled
          </td>
          <td>
            Yes
          </td>
          <td>
            boolean
          </td>
          <td>
            Capability enabled flag.
          </td>
        </tr>
        <tr>
          <td>
            accountId
          </td>
          <td>
            Yes
          </td>
          <td>
            string
          </td>
          <td>
            db8 account ID.
          </td>
        </tr>
        <tr>
          <td>
            capabilityProviderId
          </td>
          <td>
            Yes
          </td>
          <td>
            string
          </td>
          <td>
            Capability Provider ID, i.e., &quot;com.palm.facebook.calendar&quot;
          </td>
        </tr>
      </tbody>
    </table>
    <h4 id="returns-7">
      Returns
    </h4>
    <table border="1" cellpadding="5" cellspacing="5">
      <thead>
        <tr bgcolor="lightgrey">
          <th>
            Argument
          </th>
          <th>
            Type
          </th>
          <th width="400">
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            returnValue
          </td>
          <td>
            boolean
          </td>
          <td>
            <code>true</code> (success) or <code>false</code> (failure)
          </td>
        </tr>
      </tbody>
    </table><br>
    <hr>
    <h3 id="validator">
      validator
    </h3>
    <p>
      This API is called to validate a user's login (username and password). Typically, this is done over the cloud. It can return user credentials (passwords, authentication tokens) for an account and configuration information (i.e., server name, port, etc.). Credentials and configuration information can then be used in <a href="#createAccount">creating a localized user account object.</a>
    </p>
    <p>
      Validators should not modify existing account state.
    </p>
    <h4 id="syntax-8">
      Syntax
    </h4>
    <pre>
<code>{
   &quot;username&quot;    : string,
   &quot;password&quot;    : string,
   &quot;templateId&quot;  : string,
   &quot;config&quot;      : any array,
   &quot;accountId&quot;   : string
}
</code>
</pre>
    <h4 id="parameters-7">
      Parameters
    </h4>
    <table border="1" cellpadding="5" cellspacing="5">
      <thead>
        <tr bgcolor="lightgrey">
          <th>
            Argument
          </th>
          <th>
            Required
          </th>
          <th>
            Type
          </th>
          <th width="400">
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            username
          </td>
          <td>
            Yes
          </td>
          <td>
            string
          </td>
          <td>
            User name.
          </td>
        </tr>
        <tr>
          <td>
            password
          </td>
          <td>
            Yes
          </td>
          <td>
            string
          </td>
          <td>
            Password.
          </td>
        </tr>
        <tr>
          <td>
            templateId
          </td>
          <td>
            No
          </td>
          <td>
            string
          </td>
          <td>
            ID of the template file (i.e., &quot;com.palm.google&quot;). See the Template data type for more information on this file.
          </td>
        </tr>
        <tr>
          <td>
            config
          </td>
          <td>
            No
          </td>
          <td>
            any array
          </td>
          <td>
            Array of opaque configuration objects.
          </td>
        </tr>
        <tr>
          <td>
            accountId
          </td>
          <td>
            No
          </td>
          <td>
            string
          </td>
          <td>
            Only passed if modifying existing credentials.
          </td>
        </tr>
      </tbody>
    </table>
    <h4 id="returns-8">
      Returns
    </h4>
    <pre>
<code>{
   &quot;returnValue&quot;  : boolean,
   &quot;errorCode&quot;    : string,
   &quot;errorText&quot;    : string,
   &quot;templateId&quot;   : string,
   &quot;username&quot;     : string,
   &quot;alias&quot;        : string,
   &quot;credentials&quot;  : any,
   &quot;config&quot;       : any
}
</code>
</pre>
    <table border="1" cellpadding="5" cellspacing="5">
      <thead>
        <tr bgcolor="lightgrey">
          <th>
            Argument
          </th>
          <th>
            Required
          </th>
          <th>
            Type
          </th>
          <th width="400">
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            returnValue
          </td>
          <td>
            Yes
          </td>
          <td>
            boolean
          </td>
          <td>
            <code>true</code> (success) or <code>false</code> (failure).
          </td>
        </tr>
        <tr>
          <td>
            errorText
          </td>
          <td>
            No
          </td>
          <td>
            string
          </td>
          <td>
            Returned if validation fails and returnValue is false.
          </td>
        </tr>
        <tr>
          <td>
            errorCode
          </td>
          <td>
            No
          </td>
          <td>
            string
          </td>
          <td>
            Returned on failure. Has the form: &quot;errInvalidParamater&quot;, for example: &quot;errFileNotFound&quot;.
          </td>
        </tr>
        <tr>
          <td>
            templateId
          </td>
          <td>
            No
          </td>
          <td>
            string
          </td>
          <td>
            Returned if changing.
          </td>
        </tr>
        <tr>
          <td>
            username
          </td>
          <td>
            No
          </td>
          <td>
            string
          </td>
          <td>
            Returned if changing.
          </td>
        </tr>
        <tr>
          <td>
            alias
          </td>
          <td>
            No
          </td>
          <td>
            string
          </td>
          <td>
            Optional replacement for the account name, defaults to template's <code>&quot;loc_name&quot;</code>.
          </td>
        </tr>
        <tr>
          <td>
            credentials
          </td>
          <td>
            No
          </td>
          <td>
            any
          </td>
          <td>
            Array of opaque, named credentials objects.
          </td>
        </tr>
        <tr>
          <td>
            config
          </td>
          <td>
            No
          </td>
          <td>
            any
          </td>
          <td>
            Amended opaque config objects (only if changing).
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      <strong>Example</strong>
    </p>
    <p>
      <strong>Parameters</strong>
    </p>
    <pre>
<code>{ &quot;username&quot;:&quot;HoLeeSmokes&quot;,
   &quot;password&quot;: &quot;Batman&quot;, 
   &quot;accountId&quot;: &quot;2+Qn&quot;, 
   &quot;templateId&quot;: &quot;com.palm.service.sample.contacts&quot;
}
</code>
</pre>
    <p>
      <strong>Return</strong>
    </p>
    <pre>
<code>{  &quot;returnValue&quot;:true,
   &quot;templateId&quot;:&quot;com.palm.service.sample.contacts&quot;,
   &quot;credentials&quot;:{&quot;common&quot;:{&quot;secret&quot;:&quot;shhhh&quot;,&quot;authToken&quot;:&quot;xxxToken7&amp;%&quot;}},
   &quot;config&quot;:{&quot;server&quot;:&quot;sample.com&quot;,&quot;port&quot;:443}
}
</code>
</pre>
    <p>
      <a name="errors" id="errors">&#160;</a>
    </p>
    <hr>
    <h3 id="synergy-service-error-codes">
      Synergy Service Error Codes
    </h3>
    <p>
      The following table contains a set of common, standardized error codes that Synergy services should return. All of the codes are localized on the UI side. If a condition does not match any of these error codes, a Synergy service should return:
    </p>
    <pre>
<code>{
    &quot;errorCode&quot;: UNKNOWN_ERROR,
    &quot;errorText&quot;: &quot;&amp;lt;English error description message&amp;gt;&quot;
}
</code>
</pre>
    <p>
      The UI ignores <code>errorText</code> if there is a UI-localized <code>errorCode</code> version and is communicated mostly for debugging purposes.
    </p>
    <table>
      <tr>
        <th>
          Error
        </th>
        <th>
          Number
        </th>
        <th>
          Description
        </th>
      </tr>
      <tr>
        <td>
          UNKNOWN_ERROR
        </td>
        <td>
          -3141601
        </td>
        <td>
          Generic fallback error.
        </td>
      </tr>
      <tr>
        <td>
          401_UNAUTHORIZED
        </td>
        <td>
          -3141602
        </td>
        <td>
          Same as HTTP 401: Invalid credentials.
        </td>
      </tr>
      <tr>
        <td>
          408_TIMEOUT
        </td>
        <td>
          -3141603
        </td>
        <td>
          Same as HTTP 408: Request timeout.
        </td>
      </tr>
      <tr>
        <td>
          500_SERVER_ERROR
        </td>
        <td>
          -3141604
        </td>
        <td>
          Same as HTTP 500: General server error.
        </td>
      </tr>
      <tr>
        <td>
          503_SERVICE_UNAVAILABLE
        </td>
        <td>
          -3141605
        </td>
        <td>
          Same as HTTP 503: Server is (temporarily) unavailable.
        </td>
      </tr>
      <tr>
        <td>
          412_PRECONDITION_FAILED
        </td>
        <td>
          -3141606
        </td>
        <td>
          Same as HTTP 412: Precondition failed. The client request is not suitable for current configuration.
        </td>
      </tr>
      <tr>
        <td>
          400_BAD_REQUEST
        </td>
        <td>
          -3141607
        </td>
        <td>
          Same as HTTP 400. Bad request.
        </td>
      </tr>
      <tr>
        <td>
          HOST_NOT_FOUND
        </td>
        <td>
          -3141608
        </td>
        <td>
          Host not found.
        </td>
      </tr>
      <tr>
        <td>
          CONNECTION_TIMEOUT
        </td>
        <td>
          -3141609
        </td>
        <td>
          Connection timeout.
        </td>
      </tr>
      <tr>
        <td>
          CONNECTION_FAILED
        </td>
        <td>
          -3141610
        </td>
        <td>
          Miscellaneous connection failed.
        </td>
      </tr>
      <tr>
        <td>
          NO_CONNECTIVITY
        </td>
        <td>
          -3141611
        </td>
        <td>
          No connectivity.
        </td>
      </tr>
      <tr>
        <td>
          SSL_CERT_EXPIRED
        </td>
        <td>
          -3141612
        </td>
        <td>
          SSL certificate expired.
        </td>
      </tr>
      <tr>
        <td>
          SSL_CERT_UNTRUSTED
        </td>
        <td>
          -3141613
        </td>
        <td>
          SSL certificate not trusted.
        </td>
      </tr>
      <tr>
        <td>
          SSL_CERT_INVALID
        </td>
        <td>
          -3141614
        </td>
        <td>
          SSL certificate invalid.
        </td>
      </tr>
      <tr>
        <td>
          SSL_CERT_HOSTNAME_MISMATCH
        </td>
        <td>
          -3141615
        </td>
        <td>
          SSL certificate hostname mismatch.
        </td>
      </tr>
      <tr>
        <td>
          DUPLICATE_ACCOUNT
        </td>
        <td>
          -3141616
        </td>
        <td>
          Attempted, but refused to add a duplicate account.
        </td>
      </tr>
      <tr>
        <td>
          UNSUPPORTED_CAPABILITY
        </td>
        <td>
          -3141617
        </td>
        <td>
          Operation failed due to an unsupported capability. This error maps to a specific, user-friendly message.
        </td>
      </tr>
    </table>
    <p>
      <strong>Example</strong>
    </p>
    <p>
      If credentials are invalid, a validator method should return the following to the UI:
    </p>
    <pre>
<code>{
    &quot;returnValue&quot;: false,
    &quot;errorCode&quot;: 401_UNAUTHORIZED
}
</code>
</pre>
    <p>
      Note that since this is a standardized error, <code>errorText</code> is not required.
    </p>
    <p>
      <a name="CustomValidator" id="CustomValidator">&#160;</a>
    </p>
    <hr>
    <h2 id="custom-validator">
      Custom Validator
    </h2>
    <p>
      Most account templates can utilize the standard username/password Accounts UI when logging in. If not, the Accounts Framework allows template authors to specify a custom UI to display in lieu of the standard login UI. The custom UI is integrated into the account creation flow using Cross-App Push, and the custom validation UI is expected to return a result using popScene(result).
    </p>
    <h3 id="custom-validator-checklist">
      Custom Validator Checklist
    </h3>
    <ul>
      <li>Specify a CustomValidatorObj in place of a bus address string for your &quot;validator&quot; in your account template. The appId and name must refer to an app and scene.
      </li>
    </ul>
    <p>
      The validation scene must accept as input the following arguments:
    </p>
    <pre>
<code>      MyAssistant( { initialTemplate, allTemplates } )
</code>
</pre>
    <p>
      &quot;initialTemplate&quot; is optional and is only passed in if known. &quot;allTemplates&quot; is the list of known account templates as returned by &quot;com.palm.service.accounts/listAccountTemplates&quot;
    </p>
    <ul>
      <li>
        <p>
          The validation scene must determine the following:
        </p>
      </li>
      <li>The template to use when creating the account.
      </li>
      <li>The username is unique for this template.
      </li>
      <li>Handle optional config from the UI.
      </li>
      <li>The default validator login result (including credentials and, optionally, config).
      </li>
      <li>
        <p>
          Login results for all other validators (because the password is not returned, custom validation UI must do this). You can use AccountsUI.multiLogin() for this:
        </p>
        <pre>
<code>    // returns a future which will be done after validating the login against an
    // array of validator service methods.  The final result looks like:
    //
    // { defaultResult: &amp;lt;SINGLE_RESULT&amp;gt;, otherResults: [ SINGLE_RESULT, ... ] }
    //
    // (where SINGLE_RESULT=
    // { id: &amp;lt;validator id&gt;, result:&amp;lt;Validator Response&amp;gt; -OR- exception: &amp;lt;Validator Error&amp;gt; }
    // )
    //
    // If the default validator fails, the Future will error out. Other failures are
    // individually reported in 'otherResults'.
</code>
</pre>
      </li>
      <li>
        <p>
          Validation UI should return a result that looks like this:
        </p>
        <pre>
<code>{
    template: Template object,
    username: string,
    defaultResult: ResultObj,
    otherResults: array of ResultObj (optional),
    config: &amp;lt;dictionary of server settings in addition to those in ResultObjs&amp;gt;
}
</code>
</pre>
      </li>
    </ul>
    <p>
      Where TemplateObj is a Template object as returned by listAccountTemplates and ResultObj is:
    </p>
    <pre>
<code>    {
        item: {
                id: string (capability provider ID),
               validator: string (bus address of validator)
              },
        result: { (response from the validator call)
                 returnValue,
                 credentials,
                 config
                }
   }
</code>
</pre>
		</div>
	</body>
</html>